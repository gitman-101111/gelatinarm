<views:BasePage
    x:Class="Gelatinarm.Views.MainPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:views="using:Gelatinarm.Views"
    xmlns:controls="using:Gelatinarm.Controls"
    mc:Ignorable="d"
    Background="{StaticResource ApplicationPageBackgroundThemeBrush}">

    <!-- Root Grid to contain both main content and loading overlay -->
    <Grid>
        <!-- Main content grid -->
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>

            <CommandBar x:Name="MainCommandBar"
                        Grid.Row="0"
                        DefaultLabelPosition="Right"
                        Visibility="{x:Bind ViewModel.IsLoading, Mode=OneWay, Converter={StaticResource InverseBooleanToVisibilityConverter}}">
                <AppBarButton Icon="Refresh"
                              Label="Refresh"
                              Click="RefreshButton_Click" />
                <AppBarButton Icon="Find"
                              Label="Search"
                              Command="{x:Bind ViewModel.NavigateToSearchCommand}" />
                <AppBarButton Icon="Library"
                              Label="Library"
                              Command="{x:Bind ViewModel.NavigateToLibraryCommand}" />
                <AppBarButton Icon="Favorite"
                              Label="Favorites"
                              Command="{x:Bind ViewModel.NavigateToFavoritesCommand}" />
                <AppBarButton Icon="Setting"
                              Label="Settings"
                              Command="{x:Bind ViewModel.NavigateToSettingsCommand}" />
            </CommandBar>

            <ListView Grid.Row="1"
                      Padding="48,0,48,24"
                      SelectionMode="None"
                      IsItemClickEnabled="False"
                      IsTabStop="False"
                      ScrollViewer.VerticalScrollBarVisibility="Hidden"
                      ScrollViewer.VerticalScrollMode="Auto"
                      ScrollViewer.HorizontalScrollMode="Disabled"
                      IsEnabled="{x:Bind ViewModel.IsLoading, Mode=OneWay, Converter={StaticResource InverseBooleanConverter}}"
                      TabNavigation="Once">
                <ListView.ItemContainerStyle>
                    <Style TargetType="ListViewItem">
                        <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                        <Setter Property="Padding" Value="0" />
                        <Setter Property="Margin" Value="0" />
                        <Setter Property="IsTabStop" Value="False" />
                        <Setter Property="UseSystemFocusVisuals" Value="False" />
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="ListViewItem">
                                    <ContentPresenter HorizontalAlignment="Stretch"
                                                      VerticalAlignment="Top" />
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                    </Style>
                </ListView.ItemContainerStyle>

                <!-- Continue Watching Section -->
                <Grid Margin="{StaticResource SectionMargin}"
                      Visibility="{x:Bind ViewModel.HasContinueWatching, Mode=OneWay, FallbackValue=Collapsed, Converter={StaticResource BooleanToVisibilityConverter}}">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>

                    <TextBlock Grid.Row="0"
                               Text="Continue Watching"
                               Style="{StaticResource SectionHeaderTextStyle}"
                               Margin="{StaticResource ContentMargin}" />

                    <GridView Grid.Row="1"
                              x:Name="ContinueWatchingItems"
                              ItemsSource="{x:Bind ViewModel.ContinueWatchingItems, Mode=OneWay}"
                              SelectionMode="None"
                              IsItemClickEnabled="True"
                              ItemClick="GridView_ItemClick"
                              ScrollViewer.HorizontalScrollBarVisibility="Hidden"
                              ScrollViewer.HorizontalScrollMode="Auto"
                              ScrollViewer.VerticalScrollMode="Disabled"
                              ScrollViewer.IsHorizontalRailEnabled="True"
                              TabNavigation="Once"
                              XYFocusKeyboardNavigation="Enabled"

                              Padding="0,0,24,0">
                        <GridView.ItemsPanel>
                            <ItemsPanelTemplate>
                                <ItemsStackPanel Orientation="Horizontal" />
                            </ItemsPanelTemplate>
                        </GridView.ItemsPanel>
                        <GridView.ItemContainerStyle>
                            <StaticResource ResourceKey="StandardMediaGridViewItemStyle" />
                        </GridView.ItemContainerStyle>
                        <GridView.ItemTemplate>
                            <StaticResource ResourceKey="ContinueWatchingItemTemplate" />
                        </GridView.ItemTemplate>
                    </GridView>
                </Grid>

                <!-- Next Up Section -->
                <Grid Margin="{StaticResource SectionMargin}"
                      Visibility="{x:Bind ViewModel.HasNextUp, Mode=OneWay, FallbackValue=Collapsed, Converter={StaticResource BooleanToVisibilityConverter}}">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>

                    <TextBlock Grid.Row="0"
                               Text="Next Up"
                               Style="{StaticResource SectionHeaderTextStyle}"
                               Margin="{StaticResource HeaderMargin}" />

                    <GridView Grid.Row="1"
                              x:Name="NextUpItemsGrid"
                              ItemsSource="{x:Bind ViewModel.NextUpItems, Mode=OneWay}"
                              SelectionMode="None"
                              IsItemClickEnabled="True"
                              ItemClick="GridView_ItemClick"
                              ScrollViewer.HorizontalScrollBarVisibility="Hidden"
                              ScrollViewer.HorizontalScrollMode="Auto"
                              ScrollViewer.VerticalScrollMode="Disabled"
                              ScrollViewer.IsHorizontalRailEnabled="True"
                              TabNavigation="Once"
                              XYFocusKeyboardNavigation="Enabled"

                              Padding="0,0,24,0">
                        <GridView.ItemsPanel>
                            <ItemsPanelTemplate>
                                <ItemsStackPanel Orientation="Horizontal" />
                            </ItemsPanelTemplate>
                        </GridView.ItemsPanel>
                        <GridView.ItemContainerStyle>
                            <StaticResource ResourceKey="StandardMediaGridViewItemStyle" />
                        </GridView.ItemContainerStyle>
                        <GridView.ItemTemplate>
                            <StaticResource ResourceKey="ContinueWatchingItemTemplate" />
                        </GridView.ItemTemplate>
                    </GridView>
                </Grid>

                <!-- Latest Movies Section -->
                <Grid Margin="{StaticResource SectionMargin}"
                      Visibility="{x:Bind ViewModel.HasLatestMovies, Mode=OneWay, FallbackValue=Collapsed, Converter={StaticResource BooleanToVisibilityConverter}}">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>

                    <TextBlock Grid.Row="0"
                               Text="Latest Movies"
                               Style="{StaticResource SectionHeaderTextStyle}"
                               Margin="{StaticResource ContentMargin}" />

                    <ScrollViewer Grid.Row="1"
                                  HorizontalScrollMode="Enabled"
                                  VerticalScrollMode="Disabled"
                                  HorizontalScrollBarVisibility="Hidden">
                        <GridView x:Name="LatestMovies"
                                  ItemsSource="{x:Bind ViewModel.LatestMovies, Mode=OneWay}"
                                  SelectionMode="None"
                                  IsItemClickEnabled="True"
                                  ItemClick="GridView_ItemClick"
                                  ScrollViewer.HorizontalScrollMode="Disabled"
                                  ScrollViewer.VerticalScrollMode="Disabled"
                                  Padding="0,0,24,0"
                                  TabNavigation="Once"
                                  XYFocusKeyboardNavigation="Enabled">
                            <GridView.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <ItemsStackPanel Orientation="Horizontal" />
                                </ItemsPanelTemplate>
                            </GridView.ItemsPanel>
                            <GridView.ItemContainerStyle>
                                <StaticResource ResourceKey="StandardMediaGridViewItemStyle" />
                            </GridView.ItemContainerStyle>
                            <GridView.ItemTemplate>
                                <StaticResource ResourceKey="MoviePosterTemplate" />
                            </GridView.ItemTemplate>
                        </GridView>
                    </ScrollViewer>
                </Grid>

                <!-- Latest TV Shows Section -->
                <Grid Margin="{StaticResource SectionMargin}"
                      Visibility="{x:Bind ViewModel.HasLatestTVShows, Mode=OneWay, FallbackValue=Collapsed, Converter={StaticResource BooleanToVisibilityConverter}}">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>

                    <TextBlock Grid.Row="0"
                               Text="Latest TV Shows"
                               Style="{StaticResource SectionHeaderTextStyle}"
                               Margin="{StaticResource ContentMargin}" />

                    <ScrollViewer Grid.Row="1"
                                  HorizontalScrollMode="Enabled"
                                  VerticalScrollMode="Disabled"
                                  HorizontalScrollBarVisibility="Hidden">
                        <GridView x:Name="LatestTVShows"
                                  ItemsSource="{x:Bind ViewModel.LatestTVShows, Mode=OneWay}"
                                  SelectionMode="None"
                                  IsItemClickEnabled="True"
                                  ItemClick="GridView_ItemClick"
                                  ScrollViewer.HorizontalScrollMode="Disabled"
                                  ScrollViewer.VerticalScrollMode="Disabled"
                                  Padding="0,0,24,0"
                                  TabNavigation="Once"
                                  XYFocusKeyboardNavigation="Enabled">
                            <GridView.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <ItemsStackPanel Orientation="Horizontal" />
                                </ItemsPanelTemplate>
                            </GridView.ItemsPanel>
                            <GridView.ItemContainerStyle>
                                <StaticResource ResourceKey="StandardMediaGridViewItemStyle" />
                            </GridView.ItemContainerStyle>
                            <GridView.ItemTemplate>
                                <StaticResource ResourceKey="StandardPosterTemplate" />
                            </GridView.ItemTemplate>
                        </GridView>
                    </ScrollViewer>
                </Grid>

                <!-- Recently Added Section -->
                <Grid Margin="{StaticResource SectionMargin}"
                      Visibility="{x:Bind ViewModel.HasRecentlyAdded, Mode=OneWay, FallbackValue=Collapsed, Converter={StaticResource BooleanToVisibilityConverter}}">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>

                    <TextBlock Grid.Row="0"
                               Text="Recently Added"
                               Style="{StaticResource SectionHeaderTextStyle}"
                               Margin="{StaticResource ContentMargin}" />

                    <GridView Grid.Row="1"
                              ItemsSource="{x:Bind ViewModel.RecentlyAdded, Mode=OneWay}"
                              SelectionMode="None"
                              IsItemClickEnabled="True"
                              ItemClick="GridView_ItemClick"
                              ScrollViewer.HorizontalScrollBarVisibility="Hidden"
                              ScrollViewer.HorizontalScrollMode="Auto"
                              ScrollViewer.VerticalScrollMode="Disabled"
                              ScrollViewer.IsHorizontalRailEnabled="True"
                              TabNavigation="Once"
                              XYFocusKeyboardNavigation="Enabled"

                              Padding="0,0,24,0">
                        <GridView.ItemsPanel>
                            <ItemsPanelTemplate>
                                <ItemsStackPanel Orientation="Horizontal" />
                            </ItemsPanelTemplate>
                        </GridView.ItemsPanel>
                        <GridView.ItemContainerStyle>
                            <StaticResource ResourceKey="StandardMediaGridViewItemStyle" />
                        </GridView.ItemContainerStyle>
                        <GridView.ItemTemplate>
                            <StaticResource ResourceKey="RecentlyAddedTemplate" />
                        </GridView.ItemTemplate>
                    </GridView>
                </Grid>

                <!-- Recommended Section -->
                <Grid Margin="{StaticResource SectionMargin}"
                      Visibility="{x:Bind ViewModel.HasRecommended, Mode=OneWay, FallbackValue=Collapsed, Converter={StaticResource BooleanToVisibilityConverter}}">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>

                    <TextBlock Grid.Row="0"
                               Text="Recommended for You"
                               Style="{StaticResource SectionHeaderTextStyle}"
                               Margin="{StaticResource ContentMargin}" />

                    <GridView Grid.Row="1"
                              ItemsSource="{x:Bind ViewModel.Recommended, Mode=OneWay}"
                              SelectionMode="None"
                              IsItemClickEnabled="True"
                              ItemClick="GridView_ItemClick"

                              ScrollViewer.HorizontalScrollBarVisibility="Hidden"
                              ScrollViewer.HorizontalScrollMode="Auto"
                              ScrollViewer.VerticalScrollMode="Disabled"
                              ScrollViewer.IsHorizontalRailEnabled="True"
                              TabNavigation="Once"
                              XYFocusKeyboardNavigation="Enabled"
                              Padding="0,0,24,0">
                        <GridView.ItemsPanel>
                            <ItemsPanelTemplate>
                                <ItemsStackPanel Orientation="Horizontal" />
                            </ItemsPanelTemplate>
                        </GridView.ItemsPanel>
                        <GridView.ItemContainerStyle>
                            <StaticResource ResourceKey="StandardMediaGridViewItemStyle" />
                        </GridView.ItemContainerStyle>
                        <GridView.ItemTemplate>
                            <StaticResource ResourceKey="StandardPosterTemplate" />
                        </GridView.ItemTemplate>
                    </GridView>
                </Grid>
            </ListView>

        </Grid>

        <!-- LoadingOverlay on top of everything -->
        <controls:LoadingOverlay IsLoading="{x:Bind ViewModel.IsLoading, Mode=OneWay}"
                                 LoadingText="Loading content..."
                                 IsTabStop="False" />
    </Grid>
</views:BasePage>
