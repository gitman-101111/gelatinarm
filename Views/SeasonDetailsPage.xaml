<?xml version="1.0" encoding="utf-8"?>

<views:DetailsPage
    x:Class="Gelatinarm.Views.SeasonDetailsPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:views="using:Gelatinarm.Views"
    xmlns:models="using:Jellyfin.Sdk.Generated.Models"
    xmlns:controls="using:Gelatinarm.Controls"
    mc:Ignorable="d"
    Background="{StaticResource ApplicationPageBackgroundThemeBrush}"
    NavigationCacheMode="Enabled">

    <Page.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="ms-appx:///Views/DetailsPage.xaml" />
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </Page.Resources>

    <Grid>
        <!-- Backdrop Image - Full Screen Background -->
        <Image x:Name="BackdropImage"
               Source="{x:Bind ViewModel.BackdropImage, Mode=OneWay}"
               Stretch="UniformToFill"
               VerticalAlignment="Stretch"
               HorizontalAlignment="Stretch"
               Opacity="0.3" />

        <!-- Dark overlay for better text readability -->
        <Grid Background="#CC000000">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>

            <!-- Season Selector Header -->
            <Grid x:Name="HeaderGrid" Grid.Row="0"
                  Background="#CC000000"
                  Canvas.ZIndex="1">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" MinWidth="180" MaxWidth="250" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" MinWidth="100" />
                </Grid.ColumnDefinitions>

                <!-- Series Name -->
                <TextBlock Grid.Column="0"
                           x:Name="SeriesNameText"
                           Text="{x:Bind ViewModel.SeriesName, Mode=OneWay}"
                           Visibility="{x:Bind ViewModel.IsSeriesNameVisible, Mode=OneWay, Converter={StaticResource BoolToVisibility}}"
                           Style="{StaticResource PageTitleTextStyle}"
                           VerticalAlignment="Center"
                           Margin="24,20,12,20"
                           TextTrimming="CharacterEllipsis" />

                <!-- Season Tabs -->
                <ScrollViewer Grid.Column="1"
                              x:Name="SeasonTabsScroller"
                              HorizontalScrollMode="Enabled"
                              VerticalScrollMode="Disabled"
                              HorizontalScrollBarVisibility="Hidden"
                              VerticalAlignment="Center"
                              Margin="12,20,12,20"
                              ZoomMode="Disabled">
                    <ListView x:Name="SeasonTabs"
                              ItemsSource="{x:Bind ViewModel.Seasons, Mode=OneWay}"
                              SelectedIndex="{x:Bind ViewModel.SelectedSeasonIndex, Mode=TwoWay}"
                              SelectionMode="Single"
                              IsItemClickEnabled="True"
                              ItemClick="OnSeasonClick"
                              ScrollViewer.HorizontalScrollMode="Disabled"
                              ScrollViewer.VerticalScrollMode="Disabled"
                              ScrollViewer.BringIntoViewOnFocusChange="True"
                              IsTabStop="False"
                              TabNavigation="Once"
                              XYFocusDown="{Binding ElementName=EpisodesList}"
                              SingleSelectionFollowsFocus="False">
                        <ListView.ItemsPanel>
                            <ItemsPanelTemplate>
                                <StackPanel Orientation="Horizontal" />
                            </ItemsPanelTemplate>
                        </ListView.ItemsPanel>
                        <ListView.ItemContainerStyle>
                            <Style TargetType="ListViewItem">
                                <Setter Property="MinWidth" Value="80" />
                                <Setter Property="HorizontalContentAlignment" Value="Center" />
                                <Setter Property="Padding" Value="8,4" />
                            </Style>
                        </ListView.ItemContainerStyle>
                        <ListView.ItemTemplate>
                            <DataTemplate x:DataType="models:BaseItemDto">
                                <TextBlock Text="{x:Bind Name}"
                                           Style="{StaticResource StandardBodyTextStyle}"
                                           FontWeight="SemiBold"
                                           HorizontalAlignment="Center"
                                           TextAlignment="Center" />
                            </DataTemplate>
                        </ListView.ItemTemplate>
                    </ListView>
                </ScrollViewer>

                <!-- Info Button to navigate to Series -->
                <Button Grid.Column="2"
                        x:Name="InfoButton"
                        Content="&#xE946;"
                        FontFamily="Segoe MDL2 Assets"
                        FontSize="20"
                        Width="48"
                        Height="48"
                        HorizontalAlignment="Right"
                        VerticalAlignment="Center"
                        Margin="0,0,24,0"
                        Background="Transparent"
                        BorderThickness="0"
                        Click="OnInfoButtonClick"
                        ToolTipService.ToolTip="View Series Info">
                    <Button.Resources>
                        <SolidColorBrush x:Key="ButtonBackground" Color="Transparent"/>
                        <SolidColorBrush x:Key="ButtonBackgroundPointerOver" Color="#33FFFFFF"/>
                        <SolidColorBrush x:Key="ButtonBackgroundPressed" Color="#55FFFFFF"/>
                    </Button.Resources>
                </Button>
            </Grid>

            <!-- Episode Details and List -->
            <Grid x:Name="ContentGrid" Grid.Row="1">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="1*" />
                        <ColumnDefinition Width="2*" />
                    </Grid.ColumnDefinitions>

                    <!-- Selected Episode Details -->
                    <Grid Grid.Column="1"
                          Padding="12,0,24,8"
                          x:Name="EpisodeDetailsGrid">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>

                        <!-- Wrapper Grid for centering when showing series overview -->
                        <Grid Grid.Row="0"
                              Grid.RowSpan="2"
                              Visibility="{x:Bind ViewModel.IsSeriesPosterVisible, Mode=OneWay, Converter={StaticResource BoolToVisibility}}">
                            <StackPanel x:Name="SeriesOverviewPanel"
                                        VerticalAlignment="Center">
                                <!-- Series Title -->
                                <TextBlock Text="{x:Bind ViewModel.EpisodeTitle, Mode=OneWay}"
                                           Style="{StaticResource HeaderTextStyle}"
                                           TextWrapping="Wrap" />

                                <!-- Premiered info -->
                                <TextBlock Text="{x:Bind ViewModel.EpisodeNumber, Mode=OneWay}"
                                           Style="{StaticResource StandardBodyTextStyle}"
                                           Margin="{StaticResource HeaderMargin}" />

                                <!-- Action Buttons -->
                                <StackPanel Orientation="Horizontal"
                                            Margin="{StaticResource HeaderMargin}">
                                    <Button Style="{StaticResource PrimaryButtonStyle}"
                                            Command="{x:Bind ViewModel.PlayCommand}"
                                            MinWidth="140">
                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center"
                                                    VerticalAlignment="Center">
                                            <SymbolIcon Symbol="Play" Margin="0,0,8,0" />
                                            <TextBlock Text="Play" />
                                        </StackPanel>
                                    </Button>

                                    <Button Style="{StaticResource SecondaryButtonStyle}"
                                            Command="{x:Bind ViewModel.ShuffleCommand}"
                                            MinWidth="120"
                                            Margin="4,0,4,0">
                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center"
                                                    VerticalAlignment="Center">
                                            <SymbolIcon Symbol="Shuffle" Margin="0,0,8,0" />
                                            <TextBlock Text="Shuffle" />
                                        </StackPanel>
                                    </Button>

                                    <Button Style="{StaticResource SecondaryButtonStyle}"
                                            Command="{x:Bind ViewModel.ToggleWatchedCommand}"
                                            MinWidth="140"
                                            Margin="4,0,4,0">
                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center"
                                                    VerticalAlignment="Center">
                                            <SymbolIcon Symbol="Accept" Margin="0,0,8,0" />
                                            <TextBlock Text="{x:Bind ViewModel.MarkWatchedText, Mode=OneWay}" />
                                        </StackPanel>
                                    </Button>

                                    <Button Style="{StaticResource SecondaryButtonStyle}"
                                            Command="{Binding ToggleFavoriteCommand}"
                                            MinWidth="100"
                                            Margin="4,0,4,0"
                                            Visibility="Visible">
                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center"
                                                    VerticalAlignment="Center">
                                            <FontIcon
                                                Glyph="{Binding IsFavorite, Mode=OneWay, Converter={StaticResource FavoriteIconConverter}}"
                                                FontSize="16" Margin="0,0,8,0" />
                                            <TextBlock Text="{Binding FavoriteButtonText, Mode=OneWay}" />
                                        </StackPanel>
                                    </Button>
                                </StackPanel>

                                <!-- Series Overview -->
                                <TextBlock Text="{x:Bind ViewModel.EpisodeOverview, Mode=OneWay}"
                                           Style="{StaticResource StandardBodyTextStyle}"
                                           Foreground="#CCFFFFFF"
                                           TextWrapping="Wrap"
                                           Margin="{StaticResource HeaderMargin}"
                                           MaxWidth="600" />
                            </StackPanel>
                        </Grid>

                        <!-- Fixed content at top (for episodes) -->
                        <StackPanel Grid.Row="0"
                                    x:Name="EpisodeDetailsPanel"
                                    Visibility="{x:Bind ViewModel.IsEpisodesListVisible, Mode=OneWay, Converter={StaticResource BoolToVisibility}}">
                            <!-- Episode Thumbnail with Progress Overlay -->
                            <Grid Width="280"
                                  Height="157"
                                  HorizontalAlignment="Left"
                                  Margin="0,0,0,16">
                                <Border>
                                    <Image x:Name="EpisodeThumbnail"
                                           Source="{x:Bind ViewModel.EpisodeThumbnail, Mode=OneWay}"
                                           Visibility="{x:Bind ViewModel.IsEpisodeThumbnailVisible, Mode=OneWay, Converter={StaticResource BoolToVisibility}}"
                                           Stretch="UniformToFill" />
                                </Border>

                                <!-- Progress overlay on image -->
                                <Grid x:Name="ProgressContainer"
                                      VerticalAlignment="Bottom"
                                      Visibility="{x:Bind ViewModel.IsProgressVisible, Mode=OneWay, Converter={StaticResource BoolToVisibility}}">
                                    <Grid VerticalAlignment="Bottom">
                                        <Rectangle Height="4"
                                                   Fill="#33FFFFFF" />
                                        <Rectangle x:Name="WatchProgress"
                                                   Height="4"
                                                   Width="{x:Bind ViewModel.WatchProgressPercentage, Mode=OneWay, Converter={StaticResource PercentageToWidthConverter}, ConverterParameter=280}"
                                                   HorizontalAlignment="Left"
                                                   Fill="{StaticResource SystemControlHighlightAccentBrush}" />
                                    </Grid>
                                </Grid>
                            </Grid>

                            <!-- Episode Title and Info -->
                            <TextBlock x:Name="EpisodeTitle"
                                       Text="{x:Bind ViewModel.EpisodeTitle, Mode=OneWay}"
                                       Style="{StaticResource HeaderTextStyle}"
                                       TextWrapping="Wrap" />

                            <StackPanel Orientation="Horizontal"
                                        Margin="{StaticResource HeaderMargin}">
                                <TextBlock x:Name="EpisodeNumber"
                                           Text="{x:Bind ViewModel.EpisodeNumber, Mode=OneWay}"
                                           Style="{StaticResource StandardBodyTextStyle}" />
                                <TextBlock x:Name="AirDateSeparator"
                                           Text="•"
                                           Style="{StaticResource StandardBodyTextStyle}"
                                           Opacity="0.6"
                                           Margin="6,0,6,0"
                                           Visibility="{x:Bind ViewModel.IsAirDateSeparatorVisible, Mode=OneWay, Converter={StaticResource BoolToVisibility}}" />
                                <TextBlock x:Name="AirDate"
                                           Text="{x:Bind ViewModel.AirDate, Mode=OneWay}"
                                           Visibility="{x:Bind ViewModel.IsAirDateVisible, Mode=OneWay, Converter={StaticResource BoolToVisibility}}"
                                           Style="{StaticResource StandardBodyTextStyle}" />
                                <TextBlock x:Name="RuntimeSeparator"
                                           Text="•"
                                           Style="{StaticResource StandardBodyTextStyle}"
                                           Opacity="0.6"
                                           Margin="6,0,6,0"
                                           Visibility="{x:Bind ViewModel.IsRuntimeSeparatorVisible, Mode=OneWay, Converter={StaticResource BoolToVisibility}}" />
                                <TextBlock x:Name="Runtime"
                                           Text="{x:Bind ViewModel.Runtime, Mode=OneWay}"
                                           Visibility="{x:Bind ViewModel.IsRuntimeVisible, Mode=OneWay, Converter={StaticResource BoolToVisibility}}"
                                           Style="{StaticResource StandardBodyTextStyle}" />
                                <TextBlock x:Name="ResolutionSeparator"
                                           Text="•"
                                           Style="{StaticResource StandardBodyTextStyle}"
                                           Opacity="0.6"
                                           Margin="6,0,6,0"
                                           Visibility="{x:Bind ViewModel.IsResolutionSeparatorVisible, Mode=OneWay, Converter={StaticResource BoolToVisibility}}" />
                                <TextBlock x:Name="Resolution"
                                           Text="{x:Bind ViewModel.Resolution, Mode=OneWay}"
                                           Visibility="{x:Bind ViewModel.IsResolutionVisible, Mode=OneWay, Converter={StaticResource BoolToVisibility}}"
                                           Style="{StaticResource StandardBodyTextStyle}" />
                            </StackPanel>

                            <!-- Action Buttons with smaller size -->
                            <Grid Margin="{StaticResource HeaderMargin}">
                                <StackPanel Orientation="Horizontal">
                                    <!-- Play/Resume Button Container - maintains consistent position -->
                                    <Grid MinWidth="140">
                                        <Button x:Name="PlayButton"
                                                Style="{StaticResource PrimaryButtonStyle}"
                                                Command="{x:Bind ViewModel.PlayCommand}"
                                                Visibility="{x:Bind ViewModel.IsPlayButtonVisible, Mode=OneWay, Converter={StaticResource BoolToVisibility}}"
                                                MinWidth="140"
                                                IsTabStop="True"
                                                XYFocusLeft="{x:Bind EpisodesList}"
                                                XYFocusUp="{x:Bind SeasonTabs}">
                                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center"
                                                        VerticalAlignment="Center">
                                                <SymbolIcon Symbol="Play" Margin="0,0,8,0" />
                                                <TextBlock Text="{x:Bind ViewModel.PlayButtonText, Mode=OneWay}" />
                                            </StackPanel>
                                        </Button>

                                        <Button x:Name="ResumeButton"
                                                Style="{StaticResource PrimaryButtonStyle}"
                                                Command="{x:Bind ViewModel.ResumeCommand}"
                                                Visibility="{x:Bind ViewModel.IsResumeButtonVisible, Mode=OneWay, Converter={StaticResource BoolToVisibility}}"
                                                MinWidth="140"
                                                Margin="4,0,4,0"
                                                XYFocusLeft="{x:Bind EpisodesList}"
                                                XYFocusUp="{x:Bind SeasonTabs}">
                                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center"
                                                        VerticalAlignment="Center">
                                                <SymbolIcon Symbol="Play" Margin="0,0,8,0" />
                                                <TextBlock Text="Resume" />
                                            </StackPanel>
                                        </Button>
                                    </Grid>

                                    <Button x:Name="ShuffleButton"
                                            Style="{StaticResource SecondaryButtonStyle}"
                                            Command="{x:Bind ViewModel.ShuffleCommand}"
                                            MinWidth="120"
                                            Margin="4,0,4,0"
                                            Visibility="{x:Bind ViewModel.IsShuffleButtonVisible, Mode=OneWay, Converter={StaticResource BoolToVisibility}}"
>
                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center"
                                                    VerticalAlignment="Center">
                                            <SymbolIcon Symbol="Shuffle" Margin="0,0,8,0" />
                                            <TextBlock Text="Shuffle" />
                                        </StackPanel>
                                    </Button>

                                    <Button x:Name="PlayFromBeginningButton"
                                            Style="{StaticResource SecondaryButtonStyle}"
                                            Command="{x:Bind ViewModel.PlayFromBeginningCommand}"
                                            MinWidth="160"
                                            Margin="4,0,4,0"
                                            Visibility="{x:Bind ViewModel.IsPlayFromBeginningButtonVisible, Mode=OneWay, Converter={StaticResource BoolToVisibility}}"
>
                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center"
                                                    VerticalAlignment="Center">
                                            <SymbolIcon Symbol="Refresh" Margin="0,0,8,0" />
                                            <TextBlock Text="Play from Beginning" />
                                        </StackPanel>
                                    </Button>

                                    <Button x:Name="FavoriteButton"
                                            Style="{StaticResource SecondaryButtonStyle}"
                                            Command="{Binding ToggleFavoriteCommand}"
                                            MinWidth="100"
                                            Margin="4,0,4,0"
                                            Visibility="Visible"
>
                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center"
                                                    VerticalAlignment="Center">
                                            <FontIcon
                                                Glyph="{Binding IsFavorite, Mode=OneWay, Converter={StaticResource FavoriteIconConverter}}"
                                                FontSize="16" Margin="0,0,8,0" />
                                            <TextBlock Text="{Binding FavoriteButtonText, Mode=OneWay}" />
                                        </StackPanel>
                                    </Button>

                                    <Button x:Name="MarkWatchedButton"
                                            Style="{StaticResource SecondaryButtonStyle}"
                                            Command="{x:Bind ViewModel.ToggleWatchedCommand}"
                                            Visibility="{x:Bind ViewModel.IsMarkWatchedButtonVisible, Mode=OneWay, Converter={StaticResource BoolToVisibility}}"
                                            MinWidth="140"
                                            Margin="4,0,4,0"
>
                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center"
                                                    VerticalAlignment="Center">
                                            <SymbolIcon Symbol="Accept" Margin="0,0,8,0" />
                                            <TextBlock x:Name="MarkWatchedText"
                                                       Text="{x:Bind ViewModel.MarkWatchedText, Mode=OneWay}" />
                                        </StackPanel>
                                    </Button>
                                </StackPanel>
                            </Grid>
                        </StackPanel>

                        <!-- Scrollable description -->
                        <Border Grid.Row="1"
                                x:Name="DescriptionBorder"
                                BorderThickness="2"
                                BorderBrush="Transparent"
                                Margin="0,8,0,0"
                                Visibility="{x:Bind ViewModel.IsEpisodesListVisible, Mode=OneWay, Converter={StaticResource BoolToVisibility}}">
                            <ScrollViewer x:Name="DescriptionScrollViewer"
                                          VerticalScrollBarVisibility="Auto"
                                          HorizontalScrollBarVisibility="Disabled"
                                          IsTabStop="True"
                                          TabNavigation="Once"
                                          UseSystemFocusVisuals="True"
>
                                <ScrollViewer.Resources>
                                </ScrollViewer.Resources>
                                <TextBlock x:Name="EpisodeOverview"
                                           Text="{x:Bind ViewModel.EpisodeOverview, Mode=OneWay}"
                                           Style="{StaticResource StandardBodyTextStyle}"
                                           Foreground="#CCFFFFFF"
                                           TextWrapping="Wrap"
                                           Margin="8,8,8,16" />
                            </ScrollViewer>
                        </Border>
                    </Grid>

                    <!-- Episode List / Series Poster -->
                    <Grid Grid.Column="0"
                          Background="#22000000"
                          Padding="24,0,12,16">

                        <!-- Series Poster (shown for overview) -->
                        <Border x:Name="SeriesPosterContainer"
                                Width="200"
                                Height="300"

                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                Visibility="{x:Bind ViewModel.IsSeriesPosterVisible, Mode=OneWay, Converter={StaticResource BoolToVisibility}}">
                            <Image x:Name="SeriesPoster"
                                   Source="{x:Bind ViewModel.SeriesPoster, Mode=OneWay}"
                                   Stretch="UniformToFill" />
                        </Border>

                        <!-- Episodes List (shown for seasons) -->
                        <Grid x:Name="EpisodesListContainer"
                              Visibility="{x:Bind ViewModel.IsEpisodesListVisible, Mode=OneWay, Converter={StaticResource BoolToVisibility}}">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="*" />
                            </Grid.RowDefinitions>

                            <ListView x:Name="EpisodesList"
                                      Grid.Row="1"
                                      ItemsSource="{x:Bind ViewModel.Episodes, Mode=OneWay}"
                                      SelectedIndex="{x:Bind ViewModel.SelectedEpisodeIndex, Mode=TwoWay}"
                                      SelectionMode="Single"
                                      ItemClick="OnEpisodeClick"
                                      IsItemClickEnabled="True"
                                      ScrollViewer.VerticalScrollBarVisibility="Hidden"
                                      ScrollViewer.VerticalScrollMode="Enabled"
                                      ScrollViewer.IsVerticalRailEnabled="True"
                                      ScrollViewer.BringIntoViewOnFocusChange="False"
                                      Padding="0,0,0,0"
                                      Margin="0,0,0,0"
                                      XYFocusRight="{Binding ElementName=PlayButton}"
                                      XYFocusUp="{Binding ElementName=SeasonTabs}"
                                      SingleSelectionFollowsFocus="False">
                                <ListView.ItemContainerStyle>
                                    <Style TargetType="ListViewItem">
                                        <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                                        <Setter Property="Padding" Value="0" />
                                        <Setter Property="Margin" Value="0,0,0,8" />
                                    </Style>
                                </ListView.ItemContainerStyle>
                                <ListView.ItemTemplate>
                                    <DataTemplate x:DataType="models:BaseItemDto">
                                        <Grid Background="#33000000"
                                              Padding="4,4">
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                            </Grid.RowDefinitions>

                                            <!-- Episode Title with Number -->
                                            <TextBlock Grid.Row="0"
                                                       Style="{StaticResource StandardBodyTextStyle}"
                                                       FontWeight="SemiBold"
                                                       TextWrapping="NoWrap"
                                                       TextTrimming="CharacterEllipsis"
                                                       Opacity="{x:Bind UserData.Played, Converter={StaticResource PlayedToOpacityConverter}, FallbackValue=1}">
                                                <Run Text="{x:Bind IndexNumber}" /><Run Text=". " />
                                                <Run Text="{x:Bind Name}" />
                                            </TextBlock>

                                            <!-- Episode Overview with 2 line max -->
                                            <TextBlock Grid.Row="1"
                                                       Text="{x:Bind Overview}"
                                                       Style="{StaticResource StandardCaptionTextStyle}"
                                                       Foreground="#CCFFFFFF"
                                                       TextWrapping="Wrap"
                                                       MaxHeight="40"
                                                       TextTrimming="CharacterEllipsis"
                                                       Margin="0,4,0,0"
                                                       Opacity="{x:Bind UserData.Played, Converter={StaticResource PlayedToOpacityConverter}, FallbackValue=1}" />
                                        </Grid>
                                    </DataTemplate>
                                </ListView.ItemTemplate>
                            </ListView>
                        </Grid>
                    </Grid>
                </Grid>
            </Grid>
        </Grid>

        <!-- Loading Indicator -->
        <controls:LoadingOverlay x:Name="LoadingOverlay"
                                 IsLoading="{x:Bind ViewModel.IsLoading, Mode=OneWay}"
                                 LoadingText="Loading details..." />
    </Grid>
</views:DetailsPage>
